/*
Not really an advanced join
*/

DECLARE @Projects TABLE(Task_ID INT, [Start_Date] DATE, End_Date DATE)

INSERT INTO @Projects VALUES
(1,'2015-10-01','2015-10-02'),
(24,'2015-10-02','2015-10-03'),
(2,'2015-10-03','2015-10-04'),
(23,'2015-10-04','2015-10-05'),
(3,'2015-10-11','2015-10-12'),
(22,'2015-10-12','2015-10-13'),
(4,'2015-10-15','2015-10-16'),
(21,'2015-10-17','2015-10-18'),
(5,'2015-10-19','2015-10-20'),
(20,'2015-10-21','2015-10-22'),
(6,'2015-10-25','2015-10-26'),
(19,'2015-10-26','2015-10-27'),
(7,'2015-10-27','2015-10-28'),
(18,'2015-10-28','2015-10-29'),
(8,'2015-10-29','2015-10-30'),
(17,'2015-10-30','2015-10-31'),
(9,'2015-11-01','2015-11-02'),
(16,'2015-11-04','2015-11-05'),
(10,'2015-11-07','2015-11-08'),
(15,'2015-11-06','2015-11-07'),
(11,'2015-11-05','2015-11-06'),
(14,'2015-11-11','2015-11-12'),
(12,'2015-11-12','2015-11-13'),
(13,'2015-11-17','2015-11-18')



;WITH CTE (Start_Date, End_Date, RowNumber)
AS
(
	SELECT Start_Date, End_Date, ROW_NUMBER() OVER (ORDER BY Start_Date) AS RowNumber
  FROM @Projects
) 
SELECT MIN(Start_Date), MAX(End_Date) 
FROM CTE
GROUP BY DATEDIFF(DAY, RowNumber, Start_Date)
ORDER BY DATEDIFF(DAY, MIN(Start_Date), MAX(End_Date)), MIN(Start_Date);

